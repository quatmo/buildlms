#!/bin/bash
# wget -O - https://raw.githubusercontent.com/quatmo/runesq/main/blueset | sh
#/usr/bin/sudo tar -czvf /data/tag_cache.tar.gz /var/lib/mpd/tag_cache
#/usr/bin/sudo tar -xzvf /data/tag_cache.tar.gz --overwrite -C /
#tar -xzvf /tmp/albumart.tar.gz --overwrite -C /
/usr/bin/sudo echo "deb http://deb.debian.org/debian buster main" | sudo tee -a /etc/apt/sources.list
/usr/bin/sudo echo "deb-src http://deb.debian.org/debian buster main" | sudo tee -a /etc/apt/sources.list

sleep 0.3
cd /tmp
wget https://raw.githubusercontent.com/quatmo/runesq/main/mompd
/usr/bin/sudo chmod -R 755 /tmp/mompd
./mompd
echo "Index done!"

mkdir -p /tmp/BLUE
cp -rf /media/BLUEPLAYER/BLUE/* /tmp/BLUE/
/usr/bin/sudo tar -xzvf /tmp/BLUE/etc1.tar.gz --overwrite -C /
/usr/bin/sudo tar -xzvf /tmp/BLUE/etc2.tar.gz --overwrite -C /
cd /tmp
wget https://raw.githubusercontent.com/quatmo/runesq/main/up/rl.tar.gz
sleep 0.3
/usr/bin/sudo tar -xzvf /tmp/rl.tar.gz --overwrite -C /
sleep 0.3

wget https://raw.githubusercontent.com/quatmo/runesq/main/up/tag_cache.tar.gz
sleep 0.3
cp -f /tmp/tag_cache.tar.gz /data/
sleep 0.3
/usr/bin/sudo tar -xzvf /tmp/tag_cache.tar.gz --overwrite -C /
sleep 0.3

folRoot="/data/INTERNAL"
mkdir -p "$folRoot"/{VN,CDTEST,HIRES,INS,BLUE,MUSICONE,DSD,THAI}

sleep 0.3
cd /etc/systemd/system/
services="slibbol slibcdt slibhir slibmq slibse slimone volds slibthai"
for service in $services; do
  /usr/bin/sudo ln -s "/etc/.s/${service}.service" "${service}.service"
done

/usr/bin/sudo systemctl daemon-reload

for service in $services; do
  /usr/bin/sudo systemctl enable "${service}.service"
done

sleep 0.3
/usr/bin/sudo tar -xzvf /tmp/BLUE/upnp.tar.gz --overwrite -C /
sleep 0.3
/usr/bin/sudo apt-get update
sleep 0.3
/usr/bin/sudo apt-get install -y fuse3
sleep 0.3
/usr/bin/sudo apt-get install -y mc
/usr/bin/sudo apt-get install -y htop
sleep 0.3
sudo apt-get install -y default-jre
sleep 0.3
sudo apt-get install -y python3-pip
sleep 0.3
sudo pip3 install gdown
sleep 0.3
cd /tmp
#gdown --id 1AoNR0VXxuha2Ey67tjLoq6jLo2wRKNHT -O albumart.tar.gz
echo "Paste the Albumart file ID and press Enter:"
read file_id
if [ -n "$file_id" ]; then
    # Download the file using gdown
    gdown --id "$file_id" -O albumart.tar.gz
else
    echo "File ID is empty. Exiting."
fi

sleep 0.3
/usr/bin/sudo tar -xzvf /tmp/BLUE/etcfuse.tar.gz --overwrite -C /
sleep 0.3
#sudo systemctl stop mpd.service
sleep 0.3
/usr/bin/sudo /usr/bin/killall mpd
sleep 0.3
tar -xzvf /tmp/albumart.tar.gz --overwrite -C /
sleep 0.3
/usr/bin/sudo ln -s /home/volumio/upnp/upnp.service /etc/systemd/system/upnp.service
sleep 0.3

/usr/bin/sudo -v ; curl https://rclone.org/install.sh | sudo bash
sleep 0.3

rclone config

services="slibbol slibcdt slibhir slibmq slibse slimone volds slibthai"
for service in $services; do
  /usr/bin/sudo systemctl restart "${service}.service"
done


echo "Completed"

